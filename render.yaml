# render.yaml
# YouTube Translator FastAPIë¥¼ ìœ„í•œ Render.com ë°°í¬ ì„¤ì •

services:
  # ì›¹ ì„œë¹„ìŠ¤ ì •ì˜
  - type: web
    name: youtube-translator-kr
    runtime: python
    region: singapore  # í•œêµ­ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ë¦¬ì „
    plan: free  # ë¬´ë£Œ í”Œëœ
    
    # Python ë²„ì „ (ì•ˆì •ì ì¸ 3.11 ì‚¬ìš©)
    pythonVersion: "3.11"
    
    # ë¹Œë“œ ëª…ë ¹ì–´
    buildCommand: |
      echo "ğŸ”¨ ë¹Œë“œ ì‹œì‘..."
      echo "ğŸ Python ë²„ì „: $(python --version)"
      pip install --upgrade pip
      pip install -r requirements.txt
      echo "âœ… ë¹Œë“œ ì™„ë£Œ!"
    
    # ì„œë²„ ì‹œì‘ ëª…ë ¹ì–´
    startCommand: |
      echo "ğŸš€ ì„œë²„ ì‹œì‘..."
      gunicorn app.main:app \
        --bind 0.0.0.0:$PORT \
        --worker-class uvicorn.workers.UvicornWorker \
        --workers 1 \
        --timeout 30 \
        --access-logfile - \
        --error-logfile -
    
    # í™˜ê²½ ë³€ìˆ˜
    envVars:
      # Gemini API í‚¤ (Render ëŒ€ì‹œë³´ë“œì—ì„œ ì„¤ì •)
      - key: GEMINI_API_KEY
        sync: false  # ë³´ì•ˆìƒ ëŒ€ì‹œë³´ë“œì—ì„œ ìˆ˜ë™ ì…ë ¥
        
      # ê¸°ë³¸ í™˜ê²½ ë³€ìˆ˜
      - key: ENVIRONMENT
        value: production
        
      - key: DEBUG
        value: "False"
        
      - key: TZ
        value: Asia/Seoul
        
      - key: PYTHONUNBUFFERED
        value: "1"
        
      - key: ALLOWED_ORIGINS
        value: "*"  # ë°°í¬ í›„ ì‹¤ì œ ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½ í•„ìš”
    
    # í—¬ìŠ¤ì²´í¬
    healthCheckPath: /health
    
    # ìë™ ë°°í¬
    autoDeploy: true
